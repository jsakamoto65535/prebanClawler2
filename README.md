# プ〇バン自動購入ボット

このボットはプレ〇ンの新着商品を監視し、指定した商品が入荷された際に自動的にカートに追加するツールです。

## 機能

- 新着商品の自動監視
- 2段階の商品名チェック（省略表示と詳細表示）
- 指定商品の自動カート追加
- メール通知機能
- スケジュール実行モードと即時実行モードの切り替え
- ヘッドレスモード（バックグラウンド実行）の切り替え

## セットアップ

1. 必要なパッケージのインストール:
```bash
pip install -r requirements.txt
```

2. `.env`ファイルの設定:
```
# プレバンURL
SHOP_URL=https://p-bandai.jp/new_itemlist/

# Gmail設定
EMAIL_USER=your_gmail@gmail.com
EMAIL_PASSWORD=your_app_password
RECEIVER_EMAIL=receiver_email@gmail.com

# 商品名リスト設定
PRECHECK_LIST=ＨＧ 1/144,ＭＧ 1/100  # 省略表示の商品名リスト（カンマ区切り）
TARGET_LIST=商品名1,商品名2,商品名3  # 完全な商品名リスト（カンマ区切り）

# 実行モード設定
SCHEDULE_MODE=0  # 0:即時実行モード, 1:スケジュール実行モード
EXECUTE_TIME=10:59,11:59,12:59,13:59,16:59,17:59  # スケジュール実行時間（複数指定可）
EXECUTE_SCHEDULE_POLLING_PERIOD=60  # スケジュールのポーリング時間（秒）
RETRY_WAIT=60  # 即時実行モード時の検索待ち時間（秒）

# ブラウザ設定
BACKGOUND_MODE=1  # 1:ヘッドレスモード（バックグラウンド実行）, 0:通常モード（ブラウザ表示）

# カート追加設定
ADD_CART_RETRY_COUNT=30  # カート追加失敗時のリトライ回数
```

## 使用方法

1. `.env`ファイルを設定
2. プログラムを実行:
```bash
python web_shopping_bot.py
```
3. ブラウザが起動したら、ログインを手動で行い、キーを押して続行

## 動作の流れ

1. プログラム起動
2. 新着ページを表示
3. 事前チェックリストで商品を検索（省略表示の商品名でチェック）
4. 見つかった商品の詳細ページを開く
5. 詳細ページで完全な商品名をチェック
6. 商品名が一致した場合のみカートに追加
7. カートに追加できた商品をターゲットリストから削除
8. 全ての商品がカートに入るまで繰り返し

## 注意事項

- Gmailを使用する場合は、アプリパスワードを設定する必要があります
- スケジュールモードでは、指定した時間に自動的に実行されます
- 即時実行モードでは、設定した待ち時間ごとに商品をチェックします
- 商品名は2段階でチェックされます（省略表示と詳細表示）
- ヘッドレスモードではブラウザが表示されませんが、通常モードでは表示されます
- 在庫がない場合は自動的にリロードして再試行します
- 全ての商品がカートに入ったら自動的にプログラムが終了します

